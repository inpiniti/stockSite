import{_ as se,a as te,b as le,c as ne,d as ae}from"./DialogContent.vue.fqJqp6Fr.js";import{_ as oe}from"./index.p6ztR4X2.js";import{n as j,o as i,q as C,w as o,d as B,b as f,a as e,t as c,E as ie,s as d,c as v,y as X,F as T,v as q,G as re,H as b,I as ue,J as ce,K as de,L as K,M as R,W as fe,N as _e,O as ve,r as x,P as pe,B as me,Q as ge,R as he,S as F,T as we}from"./entry.d9WDy5gl.js";import{_ as xe}from"./Header.vue.BitSch4g.js";import{g as W}from"./book.GAOEFvHx.js";import{u as ye}from"./fetch.-bVTNu3G.js";const $e={class:"flex flex-col gap-4"},ke={class:"flex gap-4"},Be=["src"],Ce={class:"flex flex-col gap-4"},Te=e("div",{class:"text-sm font-bold"},"kr",-1),je=e("div",{class:"text-sm font-bold"},"jp",-1),De={key:0,class:"flex flex-col gap-1"},Ge=e("div",{class:"text-sm font-bold"},"게시판으로",-1),Ve={class:"flex flex-col gap-1"},qe={class:"text-3xl font-bold"},Le=j({__name:"namuWiki",props:{open:{type:Boolean},wiki:{},selectedBook:{}},emits:["update:open"],setup(y,{emit:a}){const p=a;return(r,_)=>{const h=se,$=te,m=le,D=oe,L=ne,k=ae;return i(),C(k,{open:r.open,"onUpdate:open":_[1]||(_[1]=g=>p("update:open"))},{default:o(()=>[f(L,{class:"w-full max-w-7xl h-5/6 overflow-y-scroll"},{default:o(()=>[e("div",$e,[f(m,null,{default:o(()=>[f(h,null,{default:o(()=>[B("만화 상세")]),_:1}),f($,null,{default:o(()=>[B(" 해당 내용은 나무위키에서 발췌한 것입니다. ")]),_:1})]),_:1}),e("div",ke,[e("img",{src:r.selectedBook.img,class:"h-56 w-fit object-cover overflow-hidden rounded-md"},null,8,Be),e("div",Ce,[e("div",null,[Te,e("div",null,c(r.selectedBook.kr),1)]),e("div",null,[je,e("div",null,c(r.selectedBook.jp),1)]),r.selectedBook.dc?(i(),v("div",De,[Ge,f(D,{variant:"outline",onClick:_[0]||(_[0]=g=>("navigateTo"in r?r.navigateTo:d(ie))(`/book/board/${r.selectedBook.kr}`))},{default:o(()=>[B(c(r.selectedBook.kr)+" 게시판으로 이동 ",1)]),_:1})])):X("",!0)])]),(i(!0),v(T,null,q(r.wiki,(g,N)=>(i(),v("div",Ve,[e("div",qe,c(N+1)+". "+c(g==null?void 0:g.title),1),e("div",null,c(g==null?void 0:g.content),1)]))),256))])]),_:1})]),_:1},8,["open"])}}}),Ne=j({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},asChild:{type:Boolean},as:{}},emits:["update:modelValue"],setup(y,{emit:a}){const _=re(y,a);return(h,$)=>(i(),C(d(de),ue(ce(d(_))),{default:o(()=>[b(h.$slots,"default")]),_:3},16))}}),Se=j({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(y){const a=y;return(p,r)=>(i(),C(d(fe),K(a,{class:d(R)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a.class)}),{default:o(()=>[b(p.$slots,"default")]),_:3},16,["class"]))}}),We=j({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(y){const a=y;return(p,r)=>(i(),C(d(_e),K(a,{class:d(R)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a.class)}),{default:o(()=>[b(p.$slots,"default")]),_:3},16,["class"]))}}),be=j({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(y){const a=y;return(p,r)=>(i(),C(d(ve),K({class:d(R)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a.class)},a),{default:o(()=>[b(p.$slots,"default")]),_:3},16,["class"]))}}),He={class:"flex flex-col p-4 gap-4 w-full"},Me={class:"flex-col flex gap-4"},Pe={class:"w-full flex flex-col gap-1"},Fe=e("div",null,[e("div",{class:"font-bold text-3xl"},"시리즈"),e("div",null,"시리즈의 전체 판매량 누적")],-1),Ke={class:"border rounded-md p-4 flex flex-row gap-1 overflow-x-scroll"},Re={key:0},Ue=["onClick"],Ee={class:"shrink-0"},Je=["src"],Oe={class:"grow-[1]"},ze={class:"font-bold"},Ie={class:"font-bold text-xs overflow-hidden whitespace-nowrap overflow-ellipsis"},Qe={class:"text-xs"},Ye={class:"w-full flex flex-col gap-1"},Ae=e("div",null,[e("div",{class:"font-bold text-3xl"},"단행본"),e("div",null,"단행본 전체 판매량 누적")],-1),Xe={class:"border rounded-md p-4 flex flex-row gap-1 overflow-x-scroll"},Ze={key:0},es={class:"flex flex-col w-40"},ss={class:"shrink-0"},ts=["src"],ls={class:"grow-[1]"},ns={class:"font-bold"},as={class:"font-bold text-xs overflow-hidden whitespace-nowrap overflow-ellipsis"},os={class:"text-xs"},vs=j({__name:"chart",setup(y){const a=x("all");async function p(s){a.value=s,await g(),await N(),await U(),D.value=[{title:"week",단행본:_.value.data,시리즈:m.value.series},{title:"month",단행본:h.value.data,시리즈:m.value.week},{title:"year",단행본:$.value.data,시리즈:m.value.year}]}const r=x(W()),_=x({data:[],error:""}),h=x({data:[],error:""}),$=x({data:[],error:""}),m=x({series:{},week:{},year:{}}),D=x([{title:"week",단행본:[],시리즈:[]},{title:"month",단행본:[],시리즈:[]},{title:"year",단행본:[],시리즈:[]}]),L=x({}),k=pe(()=>a.value==="all"?[]:we(a.value).map(s=>s.kr));async function g(){let s=F().value.from("book").select().order("sales",{ascending:!1});k.value.length>0&&(s=s.in("kr",k.value)),_.value.data.length===0?s=s.eq("date",W(1)):s=s.eq("date",r.value),_.value=await s,m.value.series=H(_.value.data)}async function N(){let s=F().value.from("book").select().gte("date",W(4)).lte("date",r.value).order("sales",{ascending:!1});k.value.length>0&&(s=s.in("kr",k.value)),h.value=await s,h.value.data=E(h.value.data),m.value.week=H(h.value.data)}async function U(){let s=F().value.from("book").select().gte("date",W(52)).lte("date",r.value).order("sales",{ascending:!1});k.value.length>0&&(s=s.in("kr",k.value)),$.value=await s,$.value.data=E($.value.data),m.value.year=H($.value.data)}function E(s){return J(s.reduce((u,n)=>(u.find(w=>w.jp===n.jp&&w.booknum===n.booknum)||u.push({jp:n.jp,booknum:n.booknum,kr:n.kr,img:n.img,sales:n.sales,dc:n.dc}),u),[]))}function H(s){return J(s.reduce((u,n)=>{const G=u.find(w=>w.jp===n.jp);return G?G.sales+=n.sales:u.push({jp:n.jp,kr:n.kr,img:n.img,sales:n.sales,dc:n.dc}),u},[]))}function J(s){return s.sort((u,n)=>n.sales-u.sales)}me(async()=>{await g(),await N(),await U(),D.value=[{title:"week",단행본:_.value.data,시리즈:m.value.series},{title:"month",단행본:h.value.data,시리즈:m.value.week},{title:"year",단행본:$.value.data,시리즈:m.value.year}]});const S=x(!1),O=x([]);async function Z(s){L.value=s;const u=s.kr,{data:n}=await ye(`/api/namuWiki/${u}`,"$sGCsx3DkoJ");O.value=n.value,S.value=!0}return(s,u)=>{const n=Le,G=xe,w=Se,z=We,I=Ne,ee=be;return i(),v(T,null,[f(n,{open:d(S),wiki:d(O),selectedBook:d(L),"onUpdate:open":u[0]||(u[0]=t=>S.value=!d(S))},null,8,["open","wiki","selectedBook"]),e("div",He,[f(G,{title:"책 차트",description:"책의 차트를 보여줍니다."}),f(I,{class:"w-full overflow-x-scroll",modelValue:d(a),"onUpdate:modelValue":u[2]||(u[2]=t=>he(a)?a.value=t:null)},{default:o(()=>[f(z,null,{default:o(()=>[f(w,{value:"all",onClick:u[1]||(u[1]=t=>p("all"))},{default:o(()=>[B(" 전체 ")]),_:1}),(i(!0),v(T,null,q(("uniqueGenreByGenre"in s?s.uniqueGenreByGenre:d(ge))(),t=>(i(),C(w,{value:t.genre_name,onClick:M=>p(t.genre_name)},{default:o(()=>[B(c(t.genre_name),1)]),_:2},1032,["value","onClick"]))),256))]),_:1})]),_:1},8,["modelValue"]),f(I,{"default-value":"month",class:"w-full"},{default:o(()=>[f(z,null,{default:o(()=>[f(w,{value:"week"},{default:o(()=>[B(" 이번주 ")]),_:1}),f(w,{value:"month"},{default:o(()=>[B(" 4주간 ")]),_:1}),f(w,{value:"year"},{default:o(()=>[B(" 1년간 ")]),_:1})]),_:1}),(i(!0),v(T,null,q(d(D),t=>(i(),C(ee,{value:t.title},{default:o(()=>{var M,Q,Y,A;return[e("div",Me,[e("div",Pe,[Fe,e("div",Ke,[((M=t==null?void 0:t.시리즈)==null?void 0:M.length)==0?(i(),v("div",Re,c(t.title=="week"?"이번주":t.title=="month"?"한달간":"1년간")+"의 "+c(d(a))+" 장르의 시리즈에 집계된 데이터가 없습니다. ",1)):(i(!0),v(T,{key:1},q((Q=t==null?void 0:t.시리즈)==null?void 0:Q.slice(0,20),(l,P)=>{var V;return i(),v("div",null,[e("div",{class:"flex flex-col w-40 cursor-pointer",onClick:is=>Z(l)},[e("div",Ee,[e("img",{class:"h-56 object-cover overflow-hidden rounded-md",src:l==null?void 0:l.img},null,8,Je)]),e("div",Oe,[e("div",null,[e("div",ze,c(P+1)+" 위",1)]),e("div",null,[e("div",Ie,c(l==null?void 0:l.kr),1)]),e("div",Qe," 판매량 "+c((V=l==null?void 0:l.sales)==null?void 0:V.toLocaleString()),1)])],8,Ue)])}),256))])]),e("div",Ye,[Ae,e("div",Xe,[((Y=t==null?void 0:t.단행본)==null?void 0:Y.length)==0?(i(),v("div",Ze,c(t.title=="week"?"이번주":t.title=="month"?"한달간":"1년간")+"의 "+c(d(a))+" 장르의 단행본에 집계된 데이터가 없습니다. ",1)):X("",!0),(i(!0),v(T,null,q((A=t==null?void 0:t.단행본)==null?void 0:A.slice(0,20),(l,P)=>{var V;return i(),v("div",null,[e("div",es,[e("div",ss,[e("img",{class:"h-56 object-cover overflow-hidden rounded-md",src:l==null?void 0:l.img},null,8,ts)]),e("div",ls,[e("div",null,[e("div",ns,c(P+1)+" 위",1)]),e("div",null,[e("div",as,c(l==null?void 0:l.kr)+" "+c(l==null?void 0:l.booknum),1)]),e("div",os," 판매량 "+c((V=l==null?void 0:l.sales)==null?void 0:V.toLocaleString()),1)])])])}),256))])])])]}),_:2},1032,["value"]))),256))]),_:1})])],64)}}});export{vs as default};
