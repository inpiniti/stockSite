import{_ as R,a as Y,b as Q,c as X,d as Z}from"./DialogContent.vue.y3wXQjp1.js";import{_ as ee,d as se,K as te,c as P,W as le,N as ae,H as ne}from"./index.SJR-CY5b.js";import{n as y,o,q as B,w as n,d as $,b as f,a as e,t as d,E as oe,s as r,c as h,y as ie,F as D,v as V,C as H,G as ce,H as re,I as E,r as g,A as de,J as W}from"./entry.CMgnyuyR.js";import{_ as ue}from"./Header.vue.fQ2N8fwc.js";import{g as S}from"./book.GAOEFvHx.js";import{u as fe}from"./fetch.XJNBdPsb.js";import"./createLucideIcon.6rslEmOf.js";const _e={class:"flex flex-col gap-4"},pe={class:"flex gap-4"},ve=["src"],me={class:"flex flex-col gap-4"},ge=e("div",{class:"text-sm font-bold"},"kr",-1),he=e("div",{class:"text-sm font-bold"},"jp",-1),we={key:0,class:"flex flex-col gap-1"},xe=e("div",{class:"text-sm font-bold"},"게시판으로",-1),$e={class:"flex flex-col gap-1"},ye={class:"text-3xl font-bold"},Be=y({__name:"namuWiki",props:{open:{type:Boolean},wiki:{},selectedBook:{}},emits:["update:open"],setup(v,{emit:a}){const i=a;return(l,u)=>{const p=R,k=Y,b=Q,L=ee,q=X,F=Z;return o(),B(F,{open:l.open,"onUpdate:open":u[1]||(u[1]=_=>i("update:open"))},{default:n(()=>[f(q,{class:"w-full max-w-7xl h-5/6 overflow-y-scroll"},{default:n(()=>[e("div",_e,[f(b,null,{default:n(()=>[f(p,null,{default:n(()=>[$("만화 상세")]),_:1}),f(k,null,{default:n(()=>[$(" 해당 내용은 나무위키에서 발췌한 것입니다. ")]),_:1})]),_:1}),e("div",pe,[e("img",{src:l.selectedBook.img,class:"h-56 w-fit object-cover overflow-hidden rounded-md"},null,8,ve),e("div",me,[e("div",null,[ge,e("div",null,d(l.selectedBook.kr),1)]),e("div",null,[he,e("div",null,d(l.selectedBook.jp),1)]),l.selectedBook.dc?(o(),h("div",we,[xe,f(L,{variant:"outline",onClick:u[0]||(u[0]=_=>("navigateTo"in l?l.navigateTo:r(oe))(`/book/board/${l.selectedBook.kr}`))},{default:n(()=>[$(d(l.selectedBook.kr)+" 게시판으로 이동 ",1)]),_:1})])):ie("",!0)])]),(o(!0),h(D,null,V(l.wiki,(_,C)=>(o(),h("div",$e,[e("div",ye,d(C+1)+". "+d(_==null?void 0:_.title),1),e("div",null,d(_==null?void 0:_.content),1)]))),256))])]),_:1})]),_:1},8,["open"])}}}),ke=y({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},asChild:{type:Boolean},as:{}},emits:["update:modelValue"],setup(v,{emit:a}){const u=se(v,a);return(p,k)=>(o(),B(r(te),ce(re(r(u))),{default:n(()=>[H(p.$slots,"default")]),_:3},16))}}),Ce=y({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(v){const a=v;return(i,l)=>(o(),B(r(le),E(a,{class:r(P)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a.class)}),{default:n(()=>[H(i.$slots,"default")]),_:3},16,["class"]))}}),je=y({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(v){const a=v;return(i,l)=>(o(),B(r(ae),E(a,{class:r(P)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a.class)}),{default:n(()=>[H(i.$slots,"default")]),_:3},16,["class"]))}}),Te=y({__name:"TabsContent",props:{value:{},forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(v){const a=v;return(i,l)=>(o(),B(r(ne),E({class:r(P)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a.class)},a),{default:n(()=>[H(i.$slots,"default")]),_:3},16,["class"]))}}),De={class:"flex flex-col p-4 gap-4 w-full"},be={class:"flex-col flex gap-4"},Ne={class:"w-full flex flex-col gap-1"},We=e("div",null,[e("div",{class:"font-bold text-3xl"},"시리즈"),e("div",null,"시리즈의 전체 판매량 누적")],-1),Se={class:"border rounded-md p-4 flex flex-row gap-1 overflow-x-scroll"},Ve=["onClick"],He={class:"shrink-0"},Le=["src"],qe={class:"grow-[1]"},Fe={class:"font-bold"},Me={class:"font-bold text-xs overflow-hidden whitespace-nowrap overflow-ellipsis"},Pe={class:"text-xs"},Ee={class:"w-full flex flex-col gap-1"},Ge=e("div",null,[e("div",{class:"font-bold text-3xl"},"단행본"),e("div",null,"단행본 전체 판매량 누적")],-1),Je={class:"border rounded-md p-4 flex flex-row gap-1 overflow-x-scroll"},Ke={class:"flex flex-col w-40"},Ue={class:"shrink-0"},ze=["src"],Ae={class:"grow-[1]"},Ie={class:"font-bold"},Oe={class:"font-bold text-xs overflow-hidden whitespace-nowrap overflow-ellipsis"},Re={class:"text-xs"},as=y({__name:"chart",setup(v){const a=g(S()),i=g({data:[],error:""}),l=g({data:[],error:""}),u=g({data:[],error:""}),p=g({series:{},week:{},year:{}}),k=g([{title:"week",단행본:[],시리즈:[]},{title:"month",단행본:[],시리즈:[]},{title:"year",단행본:[],시리즈:[]}]),b=g({});async function L(){i.value=await W().value.from("book").select().eq("date",a.value).order("sales",{ascending:!1}),i.value.data.length===0&&(i.value=await W().value.from("book").select().eq("date",S(1)).order("sales",{ascending:!1})),p.value.series=C(i.value.data)}async function q(){l.value=await W().value.from("book").select().gte("date",S(4)).lte("date",a.value).order("sales",{ascending:!1}),l.value.data=_(l.value.data),p.value.week=C(l.value.data)}async function F(){u.value=await W().value.from("book").select().gte("date",S(52)).lte("date",a.value).order("sales",{ascending:!1}),u.value.data=_(u.value.data),p.value.year=C(u.value.data)}function _(m){return G(m.reduce((c,t)=>(c.find(w=>w.jp===t.jp&&w.booknum===t.booknum)||c.push({jp:t.jp,booknum:t.booknum,kr:t.kr,img:t.img,sales:t.sales,dc:t.dc}),c),[]))}function C(m){return G(m.reduce((c,t)=>{const j=c.find(w=>w.jp===t.jp);return j?j.sales+=t.sales:c.push({jp:t.jp,kr:t.kr,img:t.img,sales:t.sales,dc:t.dc}),c},[]))}function G(m){return m.sort((c,t)=>t.sales-c.sales)}de(async()=>{await L(),await q(),await F(),k.value=[{title:"week",단행본:i.value.data,시리즈:p.value.series},{title:"month",단행본:l.value.data,시리즈:p.value.week},{title:"year",단행본:u.value.data,시리즈:p.value.year}]});const N=g(!1),J=g([]);async function z(m){b.value=m;const c=m.kr,{data:t}=await fe(`/api/namuWiki/${c}`,"$sGCsx3DkoJ");J.value=t.value,N.value=!0}return(m,c)=>{const t=Be,j=ue,w=Ce,A=je,I=Te,O=ke;return o(),h(D,null,[f(t,{open:r(N),wiki:r(J),selectedBook:r(b),"onUpdate:open":c[0]||(c[0]=x=>N.value=!r(N))},null,8,["open","wiki","selectedBook"]),e("div",De,[f(j,{title:"책 차트",description:"책의 차트를 보여줍니다."}),f(O,{"default-value":"week",class:"w-full"},{default:n(()=>[f(A,null,{default:n(()=>[f(w,{value:"week"},{default:n(()=>[$(" 이번주 ")]),_:1}),f(w,{value:"month"},{default:n(()=>[$(" 4주간 ")]),_:1}),f(w,{value:"year"},{default:n(()=>[$(" 1년간 ")]),_:1})]),_:1}),(o(!0),h(D,null,V(r(k),x=>(o(),B(I,{value:x.title},{default:n(()=>{var K,U;return[e("div",be,[e("div",Ne,[We,e("div",Se,[(o(!0),h(D,null,V((K=x==null?void 0:x.시리즈)==null?void 0:K.slice(0,20),(s,M)=>{var T;return o(),h("div",null,[e("div",{class:"flex flex-col w-40 cursor-pointer",onClick:Ye=>z(s)},[e("div",He,[e("img",{class:"h-56 object-cover overflow-hidden rounded-md",src:s==null?void 0:s.img},null,8,Le)]),e("div",qe,[e("div",null,[e("div",Fe,d(M+1)+" 위",1)]),e("div",null,[e("div",Me,d(s==null?void 0:s.kr),1)]),e("div",Pe," 판매량 "+d((T=s==null?void 0:s.sales)==null?void 0:T.toLocaleString()),1)])],8,Ve)])}),256))])]),e("div",Ee,[Ge,e("div",Je,[(o(!0),h(D,null,V((U=x==null?void 0:x.단행본)==null?void 0:U.slice(0,20),(s,M)=>{var T;return o(),h("div",null,[e("div",Ke,[e("div",Ue,[e("img",{class:"h-56 object-cover overflow-hidden rounded-md",src:s==null?void 0:s.img},null,8,ze)]),e("div",Ae,[e("div",null,[e("div",Ie,d(M+1)+" 위",1)]),e("div",null,[e("div",Oe,d(s==null?void 0:s.kr)+" "+d(s==null?void 0:s.booknum),1)]),e("div",Re," 판매량 "+d((T=s==null?void 0:s.sales)==null?void 0:T.toLocaleString()),1)])])])}),256))])])])]}),_:2},1032,["value"]))),256))]),_:1})])],64)}}});export{as as default};
